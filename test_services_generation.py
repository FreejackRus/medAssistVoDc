#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
–¢–µ—Å—Ç –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —É—Å–ª—É–≥ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç–µ–∫—Å—Ç–∞ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–æ–≥–æ –∞–ª–≥–æ—Ä–∏—Ç–º–∞
"""

import os
import sys
import pandas as pd
from service_generator import ServiceGenerator  # ‚úÖ –∏–º–ø–æ—Ä—Ç –∏–∑ –Ω–æ–≤–æ–≥–æ —Ñ–∞–π–ª–∞

EXCEL_PATH =("docs/services.xlsx")

def test_services_generation():
    """–¢–µ—Å—Ç –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —É—Å–ª—É–≥ –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –¥–∏–∞–±–µ—Ç–∞ 1 —Ç–∏–ø–∞"""

    # –ó–∞–≥—Ä—É–∂–∞–µ–º —É—Å–ª—É–≥–∏
    df = pd.read_excel(EXCEL_PATH)
    generator = ServiceGenerator(df)

    test_text = """
3. –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–ª—å–Ω—ã–µ –∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–µ—Ç–æ–¥—ãüè• –£—Å–ª—É–≥–∏
–£–ó–ò –ø–æ–¥–∂–µ–ª—É–¥–æ—á–Ω–æ–π –∂–µ–ª–µ–∑—ã :
–ù–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –¥–∏–∞–±–µ—Ç–∞ 1 —Ç–∏–ø–∞, –Ω–æ –º–æ–∂–µ—Ç –≤—ã—è–≤–∏—Ç—å –ø—Ä–∏–∑–Ω–∞–∫–∏ –∞—Ç—Ä–æ—Ñ–∏–∏ –∏–ª–∏ —Ñ–∏–±—Ä–æ–∑–∞ –≤ –ø–æ–∑–¥–Ω–∏—Ö —Å—Ç–∞–¥–∏—è—Ö.
–ú–†–¢/–ö–¢ –æ—Ä–≥–∞–Ω–æ–≤ –±—Ä—é—à–Ω–æ–π –ø–æ–ª–æ—Å—Ç–∏ :
–ù–µ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –ø—Ä–∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–µ, —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –ø–æ–¥–æ–∑—Ä–µ–Ω–∏–∏ –Ω–∞ –æ–ø—É—Ö–æ–ª–µ–≤—ã–π –ø—Ä–æ—Ü–µ—Å—Å (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∏–Ω—Å—É–ª–∏–Ω–æ–º–∞).
–ò–º–º—É–Ω–æ—Ñ–µ–Ω–æ—Ç–∏–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –ª–∏–º—Ñ–æ—Ü–∏—Ç–æ–≤ (CD4/CD8) :
–ù–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–π –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–µ.
–û—Ü–µ–Ω–∫–∞ —Ñ—É–Ω–∫—Ü–∏–∏ Œ≤-–∫–ª–µ—Ç–æ–∫ :
–ì–ª—é–∫–æ–∑–æ–∑–∞–≤–∏—Å–∏–º—ã–π –∏–Ω—Å—É–ª–∏–Ω–æ–∑–∞–≤–∏—Å–∏–º—ã–π –ø–∞–Ω–∫—Ä–µ–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ–ø—Ç–∏–¥ (C-–ø–µ–ø—Ç–∏–¥):
–ù–∞—Ç–æ—â–∞–∫: <0,2 –Ω–º–æ–ª—å/–ª ‚Äî —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –∞–±—Å–æ–ª—é—Ç–Ω—É—é –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ—Å—Ç—å.
–ü—Ä–∏ —Å—Ç–∏–º—É–ª—è—Ü–∏–∏ –≥–ª—é–∫–æ–∑–æ–π (1,75 –≥/–∫–≥): <0,3 –Ω–º–æ–ª—å/–ª ‚Äî –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ Œ≤-–∫–ª–µ—Ç–æ–∫.
–ò—Å–∫–ª—é—á–µ–Ω–∏–µ : –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ C-–ø–µ–ø—Ç–∏–¥–∞ –Ω–µ –ø—Ä–æ–≤–æ–¥–∏—Ç—Å—è –ø—Ä–∏ –∫–µ—Ç–æ–∞—Ü–∏–¥–æ–∑–µ –∏–∑-–∑–∞ –º–µ—Ç–∞–±–æ–ª–∏—á–µ—Å–∫–∏—Ö –Ω–∞—Ä—É—à–µ–Ω–∏–π.
    """

    print("=== –¢–ï–°–¢ –ì–ï–ù–ï–†–ê–¶–ò–ò –£–°–õ–£–ì ===")
    print(f"–¢–µ—Å—Ç–æ–≤—ã–π —Ç–µ–∫—Å—Ç ({len(test_text)} —Å–∏–º–≤–æ–ª–æ–≤):")
    print(test_text[:200] + "...")
    print("\n" + "="*50)

    services = generator.generate_services_for_step(test_text, step_title="–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –¥–∏–∞–±–µ—Ç–∞ 1 —Ç–∏–ø–∞")

    print(f"\n–†–µ–∑—É–ª—å—Ç–∞—Ç: –Ω–∞–π–¥–µ–Ω–æ {len(services)} —É—Å–ª—É–≥")
    for i, s in enumerate(services, 1):
        print(f"{i}. ID: {s['id']}, –ù–∞–∑–≤–∞–Ω–∏–µ: {s['name']}")

if __name__ == "__main__":
    test_services_generation()